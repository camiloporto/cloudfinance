<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
		http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd">
	
	<http entry-point-ref="restAuthenticationEntrypoint">
		<intercept-url pattern="/user/signup*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
		<intercept-url pattern="/**" access="ROLE_USER"/>
		<form-login 
			authentication-success-handler-ref="restfulAuthenticationSuccessHandler"
			authentication-failure-handler-ref="restfulAuthenticationFailureHandler"
			username-parameter="userName"
			password-parameter="pass"
			login-processing-url="/user/login"/>
		<logout/>
	</http>
	
	<authentication-manager>
		<authentication-provider>
			<user-service>
				<user name="camiloporto" authorities="ROLE_USER" password="s3cret"/>
				<user name="some@email.com" authorities="ROLE_USER" password="1234"/>
			</user-service>
		</authentication-provider>
	</authentication-manager>
	
	<beans:bean id="restAuthenticationEntrypoint" class="br.com.camiloporto.cloudfinance.security.RestAuthenticationEntryPoint">
	</beans:bean>
	
	<beans:bean id="restfulAuthenticationSuccessHandler" class="br.com.camiloporto.cloudfinance.security.RestfullSavedRequestAwareAuthenticationSuccessHandler" />
	
	<beans:bean id="restfulAuthenticationFailureHandler" class="br.com.camiloporto.cloudfinance.security.RestfulExceptionMappingAuthenticationFailureHandler" />
	
</beans:beans>
